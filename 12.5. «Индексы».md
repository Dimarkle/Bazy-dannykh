# Домашнее задание к занятию 12.5. «Индексы» Рогачев Дмитрий


# Задание 1 

```mysql
SELECT  SUM(DATA_LENGTH) , SUM(INDEX_LENGTH), CONCAT(  ROUND ((SUM(INDEX_LENGTH) / SUM(DATA_LENGTH)) *100), ' %')  AS Отношение
FROM INFORMATION_SCHEMA.TABLES 
WHERE  TABLE_SCHEMA = 'sakila';
```

# Задание 2

На мой взгляд, в данном запросе лишние операторы: distinct, over (partition by c.customer_id, f.title) и лишняя выборка по фильму таблица film. Можно использовать групировку по имени

* Оптимизировал запрос
```mysql
select  concat(c.last_name, ' ', c.first_name) as name, sum(p.amount)
from payment p, rental r, customer c, inventory i
where date(p.payment_date) = '2005-07-30' and p.payment_date = r.rental_date and r.customer_id = c.customer_id and i.inventory_id = r.inventory_id
group by name
```
