# Домашнее задание к занятию 12.5. «Индексы» Рогачев Дмитрий


# Задание 1 

```mysql
SELECT  SUM(DATA_LENGTH) , SUM(INDEX_LENGTH), CONCAT(  ROUND ((SUM(INDEX_LENGTH) / SUM(DATA_LENGTH)) *100), ' %')  AS Отношение
FROM INFORMATION_SCHEMA.TABLES 
WHERE  TABLE_SCHEMA = 'sakila';
```

# Задание 2

На мой взгляд, в данном запросе лишние операторы: distinct, over (partition by c.customer_id, f.title) и лишняя выборка по фильму таблица film. Можно использовать групировку по имени

* Оптимизировал запрос
```mysql
select  concat(c.last_name, ' ', c.first_name) as name, sum(p.amount)
from payment p, rental r, customer c, inventory i
where date(p.payment_date) = '2005-07-30' and p.payment_date = r.rental_date and r.customer_id = c.customer_id and i.inventory_id = r.inventory_id
group by name
```
![Без име5ни](https://user-images.githubusercontent.com/118626944/221376032-63e0bcb1-23cf-40b7-adac-87363c94b543.jpg)

 Ну можно еще так (групируем  таблицы):
 
 ```mysql
select 
concat(c.last_name, ' ', c.first_name) as name, sum(p.amount)
from payment p 
join rental r on p.payment_date = r.rental_date
join customer c on r.customer_id = c.customer_id 
where date(p.payment_date) = '2005-07-30'
group by c.customer_id
```
![Без име5ни](https://user-images.githubusercontent.com/118626944/221375983-e7b326eb-bbaf-4d1a-8d0d-f4b169e7c299.jpg)

